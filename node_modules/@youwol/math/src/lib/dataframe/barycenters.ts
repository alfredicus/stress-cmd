import {
    Serie,
    createTyped
} from '@youwol/dataframe'
import { vec } from '../'

export function barycenters(positions: Serie, indices: Serie): Serie {
    if (!positions || !indices) {
        return undefined
    }

    const data = new Array(indices.count).fill(0)

    let i = 0
    indices.forEach((t) => {
        const v1 = positions.itemAt(t[0]) as vec.Vector3
        const v2 = positions.itemAt(t[1]) as vec.Vector3
        const v3 = positions.itemAt(t[2]) as vec.Vector3
        data[i++] = (v1[0] + v2[0] + v3[0]) / 3
        data[i++] = (v1[1] + v2[1] + v3[1]) / 3
        data[i++] = (v1[2] + v2[2] + v3[2]) / 3
    })

    return Serie.create({
        array: createTyped(Float32Array, data, true),
        itemSize: 3,
    })
}
